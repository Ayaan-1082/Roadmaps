---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import SkeletonLayout from '../../../layouts/SkeletonLayout.astro';
import { getAllLinkGroups } from '../../../lib/link-group';
import { t } from '../../../helpers/translate';

export async function getStaticPaths() {
  const linkGroups = await getAllLinkGroups();

  return linkGroups.flatMap((linkGroup) => {
    const linkGroupLinks = linkGroup.frontmatter;

    return Object.keys(linkGroupLinks).map((slug) => {
      return {
        params: {
          linkGroupId: linkGroup.id,
          linkId: slug,
        },
        props: {
          linkGroup,
        },
      };
    });
  });
}

const { linkId } = Astro.params;
const { linkGroup } = Astro.props;

const fullUrl = linkGroup.frontmatter[linkId!];
---

<SkeletonLayout title='Redirecting..' noIndex={true} redirectUrl={fullUrl}>
  <div class='p-8'>
    <h2 class='text-xl font-bold'>{t('redirecting')}</h2>
    <p>{t('redirectingDescription')}</p>

    <p><a href={fullUrl} class='text-blue-700 underline'>{fullUrl}</a></p>
  </div>
</SkeletonLayout>
